<!doctype html>
<html lang="en">
  <head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>input,select,textarea,button{font-size:16px}</style>
  <title>Dexter ‚Ä¢ Live Trencher</title>
  <link rel="icon" href="/favicon.svg" type="image/svg+xml" />
  <script src="/agent-env.js?v=1"></script>
  <style>
    html { max-width:100%; overflow-x:hidden; }
    body { max-width:100%; }
    header, .panels, .panel { max-width:100%; box-sizing:border-box; }
    :root { color-scheme: dark; }
    body { margin: 0; font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; background:#0b0c10; color:#e6edf3; }
    header { position: sticky; top: 0; z-index: 1001; padding: 12px 16px; background: #11131a; border-bottom:1px solid #222633; display:flex; align-items:center; gap:16px; }
    .badge { padding: 2px 8px; border-radius: 999px; font-size: 12px; border:1px solid #2c3242; color:#9fb2c8; }
    .row { display:flex; gap: 12px; align-items:center; flex-wrap: wrap; }
    .terminal { padding: 16px; height: calc(100vh - 120px); overflow: auto; line-height:1.45; }
    .line { white-space: pre-wrap; word-break: break-word; }
    .t-grey { color:#98a6b3; }
    .t-yellow { color:#f2cc60; }
    .t-green { color:#7ce38b; }
    .t-red { color:#ff7b7b; }
    .panel { display:flex; gap: 12px; align-items:center; }
    .meter { height: 8px; width: 120px; background:#1a1e27; border:1px solid #2c3242; border-radius: 4px; overflow:hidden; }
    .meter > div { height:100%; background:#6dd5fa; }
    .sticky { position: sticky; top: 48px; z-index: 1000; background:#0b0c10; padding:6px 16px; border-bottom:1px solid #1a1e27; }
    .dim { opacity: 0.8; }
    /* Sticky status bar summary */
    #now.statusbar { display:flex; align-items:center; gap:8px; padding:6px 16px; font-size:12px; white-space:nowrap; text-overflow:ellipsis; z-index:500; }
    #now .conn { padding:2px 8px; border-radius:999px; border:1px solid #2c3242; background:#121521; }
    #now .conn.ok { color:#79e08f; border-color:#2a4a36; background:#0f1612; }
    #now .conn.warn { color:#f2cc60; border-color:#4a3f2a; background:#15130f; }
    #now .conn.bad { color:#ff7b7b; border-color:#5a2a30; background:#1a1112; }
    #now .spacer { flex:1 1 auto; }
    #now .last { color:#9fb2c8; display:inline-flex; gap:6px; align-items:center; }
    #now .last .txt { overflow:hidden; text-overflow:ellipsis; white-space:nowrap; max-width:70vw; display:inline-block; }
    @media (max-width: 600px){ #now .last .txt { max-width: 50vw; } }
    #now .ago { opacity:.7; font-size:11px; }
    /* Animations */
    @keyframes nowFlash { from { opacity:0; transform: translateY(-4px);} to { opacity:1; transform: translateY(0);} }
    @keyframes nowFadeOut { from { opacity:1; transform: translateY(0);} to { opacity:0; transform: translateY(-4px);} }
    #now .last.flash { animation: nowFlash .25s ease; }
    #now .last.fadeout { animation: nowFadeOut .25s ease forwards; }
    @keyframes connPulse { 0%{ box-shadow:0 0 0 0 rgba(121,224,143,.3);} 100%{ box-shadow:0 0 0 6px rgba(121,224,143,0);} }
    @keyframes connPulseWarn { 0%{ box-shadow:0 0 0 0 rgba(242,204,96,.3);} 100%{ box-shadow:0 0 0 6px rgba(242,204,96,0);} }
    @keyframes connPulseBad { 0%{ box-shadow:0 0 0 0 rgba(255,123,123,.3);} 100%{ box-shadow:0 0 0 6px rgba(255,123,123,0);} }
    #now .conn.pulse-ok, #connbar.pulse-ok { animation: connPulse .5s ease; }
    #now .conn.pulse-warn, #connbar.pulse-warn { animation: connPulseWarn .5s ease; }
    #now .conn.pulse-bad, #connbar.pulse-bad { animation: connPulseBad .5s ease; }
    /* Header connection badge colors */
    #connbar.ok { color:#79e08f; border-color:#2a4a36; background:#0f1612; }
    #connbar.warn { color:#f2cc60; border-color:#4a3f2a; background:#15130f; }
    #connbar.bad { color:#ff7b7b; border-color:#5a2a30; background:#1a1112; }
    a { color:#8ab4ff; text-decoration:none; }
    /* minimal */
    /* Voice banner */
    #voiceBanner { display:none; margin:8px 16px; padding:6px 10px; border:1px solid #5a4a1a; border-radius:6px; background:#15130f; color:#f2cc60; font-size:12px }
  </style>
</head>
  <body>
  <header>
    <div class="row" style="width:100%">
      <div class="row">
        <a href="/agent-dashboard.html" style="color:#e6edf3;text-decoration:none"><strong>Dexter ‚Ä¢ Live Trenching</strong></a>
        <form id="runForm" class="row" style="margin-left:16px; gap:6px" onsubmit="return false;">
          <span id="mintWrap" class="input-wrap" style="position:relative;display:inline-block">
            <input id="mintInput" placeholder="Select or type token address" style="background:#0b0c10;border:1px solid #2c3242;border-radius:4px;color:#e6edf3;padding:3px 32px 3px 8px;width:220px;font-size:12px" />
            <button id="mintClear" type="button" title="Clear" aria-label="Clear mint" style="display:none;position:absolute;right:6px;top:50%;transform:translateY(-50%);width:16px;height:16px;border:1px solid #5a2a30;border-radius:999px;background:#1a1112;color:#ff6b6b;cursor:pointer;line-height:14px;padding:0;z-index:1001;font-size:12px">√ó</button>
            <div id="mintSuggest" style="display:none;position:absolute;top:calc(100% + 4px);left:0;width:100%;max-height:180px;overflow:auto;border:1px solid #2c3242;border-radius:4px;background:#0b0c10;z-index:11000;font-size:12px;line-height:1.3"></div>
          </span>
          <datalist id="mintPresets">
            <option label="LLM" value="BnszRWbs9LxSzsCUUS57HMTNNtyDHFsnmZ1mVhAYdaos"></option>
            <option label="CLANKER" value="3qq54YqAKG3TcrwNHXFSpMCWoL8gmMuPceJ4FG9npump"></option>
            <option label="BUTTPLUG" value="2ZqgkCpvXjzB4NstzBUPSrsYrrbziUv5mC9CsxSQZryG"></option>
          </datalist>
          <button id="runBtn" type="button" title="Run" style="background:#0f1612;color:#79e08f;border:1px solid #2a4a36;border-radius:4px;padding:3px 8px;cursor:pointer;font-size:12px;line-height:1">‚ûî</button>
        </form>
      </div>
      <div class="row" style="margin-left:auto; gap:8px">
        <span id="modelbar" class="badge dim">Model: ‚Äî</span>
        <button id="debugLoadBtn" title="Load Debug Report" style="background:transparent;border:none;color:#9fb2c8;cursor:pointer;font-size:14px;padding:2px 6px">üìÅ</button>
        <button id="voiceBtn" class="badge" title="Start voice">Voice: Off</button>
        <button id="tracesToggle" class="badge" title="Toggle traces">Traces</button>
        <span id="connbar" class="badge">Connecting‚Ä¶</span>
        <span id="runsbar" class="badge dim">Active: 0/3</span>
      </div>
    </div>

    <!-- Report Loader Modal -->
    <div id="reportModal" style="display:none; position:fixed; inset:0; background:rgba(0,0,0,0.55); z-index:1000; align-items:center; justify-content:center;">
      <div style="background:#0b0f14; color:#d8e0ea; border:1px solid #1c2733; border-radius:8px; width:min(920px, 95vw); max-height:85vh; display:flex; flex-direction:column; overflow:hidden; box-shadow:0 10px 30px rgba(0,0,0,0.6)">
        <div style="display:flex; align-items:center; gap:8px; padding:10px 12px; border-bottom:1px solid #1c2733; background:#0d1319;">
          <strong style="font-size:14px">Load Report</strong>
          <input id="reportSearch" type="text" placeholder="Filter by file or mint‚Ä¶" style="margin-left:12px; flex:1; background:#0a1016; color:#c7d1dc; border:1px solid #203042; border-radius:4px; padding:6px 8px; font-size:12px" />
          <label style="display:flex; align-items:center; gap:6px; font-size:12px; color:#9fb2c8">
            <input id="reportSkipSpark" type="checkbox" /> Skip sparkline
          </label>
          <button id="reportClose" title="Close" style="background:#0f161f; color:#9fb2c8; border:1px solid #2a3b4d; border-radius:4px; padding:6px 10px; cursor:pointer; font-size:12px">Close</button>
        </div>
        <div style="display:flex; gap:0; flex:1; min-height:300px;">
          <div style="flex:1; min-width:320px; border-right:1px solid #1c2733; overflow:auto">
            <div id="reportResults" style="display:flex; flex-direction:column;">
              <!-- rows injected here -->
            </div>
          </div>
          <div style="flex:1.1; min-width:320px; overflow:auto; padding:10px 12px;">
            <div id="reportPreview" style="font-size:12px; color:#b8c6d6; white-space:pre-wrap"></div>
          </div>
        </div>
        <div style="display:flex; align-items:center; justify-content:space-between; padding:8px 12px; border-top:1px solid #1c2733; background:#0d1319; font-size:12px; color:#90a6bd">
          <div id="reportStatus">Loading‚Ä¶</div>
          <div style="display:flex; align-items:center; gap:8px">
            <select id="reportPageSize" style="background:#0a1016; color:#c7d1dc; border:1px solid #203042; border-radius:4px; padding:4px 6px; font-size:12px">
              <option value="10">10</option>
              <option value="20" selected>20</option>
              <option value="50">50</option>
              <option value="100">100</option>
            </select>
            <button id="reportPrev" style="background:#0f161f; color:#9fb2c8; border:1px solid #2a3b4d; border-radius:4px; padding:4px 8px; cursor:pointer; font-size:12px">Prev</button>
            <button id="reportNext" style="background:#0f161f; color:#9fb2c8; border:1px solid #2a3b4d; border-radius:4px; padding:4px 8px; cursor:pointer; font-size:12px">Next</button>
          </div>
        </div>
      </div>
    </div>
  </header>

  <div class="sticky dim statusbar" id="now">Waiting for sessions‚Ä¶</div>
  
  <!-- All Traces Panel (collapsible) -->
  <div id="tracesPanel" style="display:none; margin:8px 16px; border:1px solid #1a1e27; border-radius:6px; background:#0f1117;">
    <div style="display:flex; gap:8px; align-items:center; padding:6px 8px; border-bottom:1px solid #1a1e27;">
      <strong style="font-size:12px">All Traces</strong>
      <label style="font-size:11px; color:#9fb2c8; display:inline-flex; align-items:center; gap:4px">Step
        <select id="tracesStep" style="background:#0a1016; color:#c7d1dc; border:1px solid #203042; border-radius:4px; padding:2px 4px; font-size:11px">
          <option value="">all</option>
          <option>bootstrap</option>
          <option>socials</option>
          <option>website</option>
          <option>twitter</option>
          <option>telegram</option>
          <option>market</option>
          <option>finalize</option>
          <option>persist</option>
        </select>
      </label>
      <label style="font-size:11px; color:#9fb2c8; display:inline-flex; align-items:center; gap:4px">Kind
        <select id="tracesKind" style="background:#0a1016; color:#c7d1dc; border:1px solid #203042; border-radius:4px; padding:2px 4px; font-size:11px">
          <option value="">all</option>
          <option>step_start</option>
          <option>step_end</option>
          <option>status</option>
          <option>error</option>
          <option>runner_log</option>
        </select>
      </label>
      <input id="tracesSearch" placeholder="search‚Ä¶" style="margin-left:auto; flex:1; max-width:300px; background:#0a1016; color:#c7d1dc; border:1px solid #203042; border-radius:4px; padding:3px 6px; font-size:11px" />
      <button id="tracesPause" class="badge" style="font-size:11px">Pause</button>
      <button id="tracesClear" class="badge" style="font-size:11px">Clear</button>
    </div>
    <div id="tracesList" style="max-height:220px; overflow:auto; font-size:12px; padding:6px 8px"></div>
  </div>
  
  <style>
    /* Realtime Voice Debug panel */
    .voice-debug { margin: 8px 16px; border:1px solid #1a1e27; border-radius:6px; background:#0f1117; }
    .voice-debug .vd-head { display:flex; flex-wrap:wrap; gap:8px; align-items:center; padding:6px 8px; border-bottom:1px solid #1a1e27; background:#0f1117; }
    .voice-debug .vd-head .spacer { flex:1 1 auto; }
    .voice-debug .vd-btn { font-size:11px; padding:2px 6px; border:1px solid #2c3242; border-radius:4px; color:#9fb2c8; background:#121521; cursor:pointer; }
    .voice-debug .vd-btn:hover { color:#e6edf3; border-color:#3a4155; }
    .voice-debug .vd-badge { font-size:11px; padding:2px 8px; border:1px solid #2c3242; border-radius:999px; color:#9fb2c8; }
    .voice-debug .vd-badge.ok { color:#79e08f; border-color:#2a4a36; background:#0f1612; }
    .voice-debug .vd-badge.warn { color:#f2cc60; border-color:#4a3f2a; background:#15130f; }
    .voice-debug .vd-badge.bad { color:#ff7b7b; border-color:#5a2a30; background:#1a1112; }
    .voice-debug .vd-log { 
      max-height: 0; 
      overflow: hidden; 
      font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace; 
      font-size:12px; 
      line-height:1.35; 
      background:#0b0c10; 
      transition: max-height 0.3s ease-out, padding 0.3s ease-out;
    }
    .voice-debug .vd-log.expanded { 
      max-height: 220px; 
      padding: 8px;
      overflow: auto;
    }
    .voice-debug .vd-line { white-space: pre-wrap; word-break: break-word; color:#c8d1dc; }
    .voice-debug .vd-line .ts { color:#98a6b3; }
    .voice-debug .vd-line.err { color:#ff7b7b; }
    .voice-debug .vd-line.warn { color:#f2cc60; }
  </style>
  
  <section id="voiceDebug" class="voice-debug">
    <div class="vd-head">
      <strong style="font-size:12px">Realtime Voice Debug</strong>
      <span id="vdStatus" class="vd-badge warn">Idle</span>
      <div class="spacer"></div>
      <button id="vdMute" class="vd-btn" title="Mute" style="color:#79e08f;font-size:14px">üé§</button>
      <button id="vdStop" class="vd-btn" title="Stop" style="color:#ff7b7b;font-size:14px">‚ñ†</button>
      <button id="vdClear" class="vd-btn" title="Clear" style="color:#f2cc60;font-size:14px">‚å´</button>
      <div style="position:relative">
        <button id="vdMenu" class="vd-btn">‚ãØ</button>
        <div id="vdMenuDrop" style="display:none;position:absolute;right:0;top:100%;margin-top:4px;background:#121521;border:1px solid #2c3242;border-radius:4px;padding:4px;min-width:120px;z-index:1000">
          <button id="vdCheck" class="vd-btn" style="display:block;width:100%;text-align:left;margin-bottom:4px">Check</button>
          <button id="vdHealth" class="vd-btn" style="display:block;width:100%;text-align:left;margin-bottom:4px">Health</button>
          <button id="vdSend" class="vd-btn" style="display:block;width:100%;text-align:left;margin-bottom:4px">Send Logs</button>
          <button id="vdVerbose" class="vd-btn" data-on="1" style="display:block;width:100%;text-align:left;margin-bottom:4px">Verbose: On</button>
          <button id="vdTestCapture" class="vd-btn" style="display:block;width:100%;text-align:left;margin-bottom:4px">Test Capture</button>
          <button id="vdCopy" class="vd-btn" style="display:block;width:100%;text-align:left">Copy</button>
        </div>
      </div>
    </div>
    <div id="vdLog" class="vd-log"></div>
  </section>

  <style>
    /* Tab navigation */
    .panel-tabs { display:flex; gap:4px; padding: 8px 16px 0; background:#0b0c10; border-bottom:1px solid #1a1e27; position: sticky; top: 96px; z-index: 999; }
    .panel-tab { padding: 6px 12px; background:#0f1117; border:1px solid #1a1e27; border-bottom:none; border-radius: 6px 6px 0 0; cursor:pointer; font-size:12px; color:#9fb2c8; display:flex; align-items:center; gap:6px; }
    .panel-tab:hover { color:#e6edf3; background:#121521; }
    .panel-tab.active { background:#0b0c10; color:#e6edf3; border-bottom:1px solid #0b0c10; margin-bottom:-1px; }
    .panel-tab .close { margin-left:4px; color:#ff6b6b; cursor:pointer; font-size:14px; line-height:1; }
    .panel-tab .close:hover { color:#ff8181; }
    
    /* Panels container - single panel visible at a time */
    .panels { padding: 0 16px 16px; }
    .panel { display:none; border:1px solid #1a1e27; border-radius: 6px; background:#0b0c10; flex-direction:column; min-height: 220px; margin: 8px 0; }
    .panel.active { display:flex; }
    .panel header { display:flex; gap:12px; align-items:center; padding:8px 10px; background:#0f1117; border-bottom:1px solid #1a1e27; flex-wrap: wrap; overflow: visible; }
    .panel header .spacer { flex: 1 1 auto; }
    .panel header .iconbtn { background:#121521; color:#9fb2c8; border:1px solid #2c3242; border-radius:4px; padding:2px 8px; font-size:12px; cursor:pointer; }
    .panel header .iconbtn:hover { color:#e6edf3; border-color:#3a4155; }
    .panel header .iconbtn.warn { color:#f2cc60; border-color:#5a4a1a; background:#15130f; }
    .panel header .iconbtn.danger { color:#ff6b6b; border-color:#5a2a30; background:#1a1112; }
    .panel header .iconbtn.danger:hover { color:#ff8181; border-color:#7a343c; background:#201214; }
    .panel header .titlewrap { display:flex; align-items:baseline; gap:10px; }
    .panel header .titlewrap .title { font-size:16px; font-weight:700; color:#e6edf3; }
    .panel header .titlewrap .symbol { font-size:14px; font-weight:600; color:#c8d1dc; }
    .panel header .addr { font-size:11px; color:#9fb2c8; cursor:pointer; }
    .panel header .addr:hover { color:#e6edf3; }
    .panel header .status { font-size:12px; font-weight:600; padding:2px 8px; border-radius:999px; border:1px solid #2c3242; background:#121521; color:#9fb2c8; }
    .panel header .timer { font-size:12px; font-weight:600; color:#9fb2c8; }
    .panel .terminal { padding: 8px; height: 220px; overflow:auto; font-size:12px; line-height:1.4; font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace; background:#0f1117; border:1px solid #1a1e27; border-radius:6px; }
    /* Hide scrollbar visuals but keep scroll behavior */
    .panel .terminal { scrollbar-width: none; -ms-overflow-style: none; }
    .panel .terminal::-webkit-scrollbar { width: 0; height: 0; }
    /* Let narrative flow with page scroll to avoid nested scrollbars */
    .panel .narr { padding: 8px; max-height: none; overflow: visible; font-size:13px; line-height:1.5; border-top:1px solid #1a1e27; color:#e6edf3; }
    .panel .narr h4 { margin:6px 0; font-size:12px; color:#9fb2c8; }
    .panel .narr .final { border-top:1px solid #1a1e27; margin-top:8px; padding-top:8px; }
    /* Memory digest: grow naturally (no internal scroll) */
    .panel .context { padding:8px; border-bottom:1px solid #1a1e27; display:none; }
    .panel .context .title { font-size:12px; color:#9fb2c8; margin-bottom:4px; display:flex; align-items:center; gap:8px; }
    .panel .context .body { font-size:12px; color:#c8d1dc; white-space:pre-wrap; }
    .panel .context .toggle { background:#121521; color:#9fb2c8; border:1px solid #2c3242; border-radius:4px; padding:2px 6px; font-size:11px; cursor:pointer; }
    .panel .timeline { padding: 8px; border-top:1px solid #1a1e27; }
    /* Make signals a responsive grid */
    .panel .signals { padding: 8px; border-top:1px solid #1a1e27; display:grid; grid-template-columns: repeat(auto-fill, minmax(220px, 1fr)); gap: 6px 10px; max-width:100%; box-sizing:border-box; }
    /* Links grid: denser to fit more per row */
    .panel .links { padding: 8px; border-top:1px solid #1a1e27; display:grid; grid-template-columns: repeat(auto-fill, minmax(140px, 1fr)); gap: 6px 8px; max-width:100%; box-sizing:border-box; }
    .panel .links .sig { font-size:13px; padding:4px 6px; color:#c8d1dc; border:1px solid #1a1e27; border-radius:6px; display:flex; align-items:center; gap:8px; }
    .panel .links .sig img.fav { width:14px; height:14px; border-radius:3px; display:block; }
    .panel .links .sig a, .panel .signals .sig a { overflow:hidden; text-overflow:ellipsis; white-space:nowrap; display:inline-block; max-width:100%; }
    .panel .timeline .step { display:flex; align-items:center; gap:8px; font-size:13px; padding:2px 0; color:#9fb2c8; }
    .panel .timeline .step.active { color:#e6edf3; }
    .panel .timeline .step.done { color:#7ce38b; }
    .panel .timeline .step.skipped { color:#f2cc60; }
    .panel .timeline .step.failed { color:#ff7b7b; }
    .panel .timeline .ms { font-size:11px; color:#98a6b3; margin-left:auto; }
    .panel .timeline .step:hover { background:#0d1117; }
    .panel .timeline .step .label { cursor:pointer; }
    .panel .timeline .details { display:none; padding:4px 8px 8px 20px; font-size:12px; color:#9fb2c8; border-left:2px solid #1a1e27; }
    .panel .timeline .details.open { display:block; }
    .panel .timeline .logline { white-space:pre-wrap; word-break:break-word; margin:2px 0; }
    .panel .signals .sig { font-size:13px; padding:4px 6px; color:#c8d1dc; border:1px solid #1a1e27; border-radius:6px; display:flex; align-items:center; gap:8px; }
    .panel .signals .sig .tag { font-size:11px; color:#98a6b3; border:1px solid #2c3242; padding:1px 6px; border-radius:999px; margin-right:6px; }
    .panel .signals .sig img.fav { width:14px; height:14px; border-radius:3px; display:block; }
    .p-badge { padding: 2px 6px; border:1px solid #2c3242; border-radius: 999px; font-size: 11px; color:#9fb2c8; white-space: nowrap; }
    .p-badge.ok { color:#79e08f; border-color:#2a4a36; background:#0f1612; }
    .p-badge.warn { color:#f2cc60; border-color:#4a3f2a; background:#15130f; }
    .p-badge.bad { color:#ff7b7b; border-color:#5a2a30; background:#1a1112; }
    /* Use responsive columns (remove forced single-column override) */
    /* .panels grid is defined above with responsive breakpoints */
    /* Constrain ALL primary inner sections to the same width */
    .panel header, .panel .market, .panel .context, .panel .timeline, .panel .terminal, .panel .narr, .panel .signals, .panel .bodygrid, .panel .finalwrap { max-width: 960px; margin-left:auto; margin-right:auto; }
    /* Side-by-side layout for checklist (timeline) and stream (terminal+narr) */
    .panel .bodygrid { display:grid; grid-template-columns: 240px 1fr; gap: 8px 12px; align-items:start; padding: 0; }
    @media (max-width: 960px){ .panel .bodygrid { grid-template-columns: 1fr; } }
    .panel .timeline { text-align:left; }
    .panel .streamwrap { display:flex; flex-direction:column; gap:8px; }
    /* Memory Digest formatting */
    .panel .context .kv { display:grid; grid-template-columns: 96px 1fr; gap: 4px 10px; align-items:start; }
    .panel .context .kv .label { font-size:11px; color:#9fb2c8; }
    .panel .context .kv .value { font-size:12px; color:#c8d1dc; }
    .panel .context ul { margin: 4px 0 8px; padding-left: 18px; }
    .panel .context ul.pros-list li { color:#9fe3ad; }
    .panel .context ul.pros-list li::marker { color:#79e08f; }
    .panel .context ul.cons-list li { color:#ff9b9b; }
    .panel .context ul.cons-list li::marker { color:#ff6b6b; }
    .panel .context .chips { display:flex; flex-wrap:wrap; gap:6px; }
    .panel .context .chip { font-size:11px; padding:2px 6px; border:1px solid #2c3242; border-radius:999px; color:#9fb2c8; }
    /* Final report section (full panel width below bodygrid) */
    .panel .finalwrap { padding: 8px; border-top:1px solid #1a1e27; }
    .panel .finalwrap h3 { margin:8px 0 6px; font-size:14px; color:#e6edf3; }
    .panel .finalwrap .final { border:1px solid #1a1e27; border-radius:6px; padding:8px; background:#0f1117; }
    /* Market snapshot */
    .panel .market { display:grid; grid-template-columns: repeat(4, minmax(0, 1fr)); gap:8px; align-items:center; padding: 8px; border-bottom:1px solid #1a1e27; }
    @media (max-width: 800px){ .panel .market { grid-template-columns: repeat(2, minmax(0,1fr)); } }
    .market .metric { background:#0f1117; border:1px solid #1a1e27; border-radius:6px; padding:6px 8px; }
    .market .metric .label { font-size:11px; color:#9fb2c8; }
    .market .metric .value { font-size:14px; font-weight:600; color:#e6edf3; }
    .market .sparkwrap { grid-column: span 2; display:flex; align-items:center; justify-content:flex-start; gap:8px; }
    /* Toast */
    #toast { position: fixed; top: 12px; right: 12px; background:#0f1117; border:1px solid #2c3242; color:#e6edf3; padding:8px 10px; border-radius:6px; font-size:12px; opacity:0; transform: translateY(-8px); transition: opacity .2s, transform .2s; z-index:9999; }
    #toast.show { opacity:1; transform: translateY(0); }
    /* Clear button disabled look */
    #mintClear:disabled { opacity: 0.5; cursor: default; }
    /* Clear hover */
    #mintClear:not(:disabled):hover { color:#ff8181; border-color:#7a343c; }
    /* Suggestion styles */
    #mintSuggest .item { transition: background .12s, border-color .12s; }
    #mintSuggest .item:hover { background:#10131a; }
    #mintSuggest .item.active { background:#121521; border-color:#2c3242 !important; }
    /* iOS Safari input zoom prevention: ensure 16px minimum on small screens */
    @media (max-width: 640px){
      #mintInput { font-size: 16px !important; }
      #mintSuggest { font-size: 14px !important; }
      #mintSuggest .item { font-size: 14px !important; line-height: 1.3 !important; }
    }
  </style>

  <div id="panelTabs" class="panel-tabs" style="display:none;"></div>

  <section id="panels" class="panels"></section>
  
  <div id="voiceBanner">Voice unavailable: missing server OPENAI_API_KEY</div>
  
  <div id="toast" aria-live="polite"></div>
  
  <div id="walletsOverlay" style="display:none; position:fixed; right:12px; top:54px; width:360px; max-height:60vh; overflow:auto; background:#0f1117; border:1px solid #1a1e27; border-radius:8px; z-index:10000; box-shadow:0 8px 20px rgba(0,0,0,.35)">
    <div style="display:flex; align-items:center; gap:8px; padding:8px 10px; border-bottom:1px solid #1a1e27; background:#0f1117; position:sticky; top:0">
      <strong style="font-size:12px">Wallets</strong>
      <span id="walletDefaultTag" class="vd-badge" style="margin-left:auto">Default: ‚Äî</span>
      <button id="walletClose" class="vd-btn">√ó</button>
    </div>
    <div id="walletList" style="padding:8px 10px; display:grid; gap:8px"></div>
  </div>

  <!-- Load modular JavaScript files -->
  <script type="module" src="/js/live/utils.js"></script>
  <script type="module" src="/js/live/debug.js"></script>
  <script type="module" src="/js/live/voice.js"></script>
  <script type="module" src="/js/live/tools.js"></script>
  <script type="module" src="/js/live/wallets.js"></script>
  <script type="module" src="/js/live/runs.js"></script>
  <script type="module" src="/js/live/market.js"></script>
  <script type="module" src="/js/live/forms.js"></script>
  <script type="module" src="/js/live/panels.js"></script>
  <script type="module" src="/js/live/main.js"></script>

  <script>
    // Optional Supabase bootstrap: fetch config, init client, and hold session
    window.SUPABASE = { client: null, session: null };
    (async function initSupabase(){
      try {
          const r = await fetch('/auth/config', { cache:'no-cache' });
          const j = await r.json().catch(()=>null);
          if (!j?.ok || !j?.supabaseUrl || !j?.supabaseAnonKey) return;
          const url = j.supabaseUrl; const key = j.supabaseAnonKey;
          const el = document.createElement('script');
          el.src = 'https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/dist/umd/supabase.js';
          el.async = true; el.onload = async ()=>{
            try {
              const sb = window.supabase.createClient(url, key, { auth: { persistSession:true, autoRefreshToken:true } });
              window.SUPABASE.client = sb;
              const { data } = await sb.auth.getSession();
              window.SUPABASE.session = data?.session || null;
              try { console.log('[supabase] session', !!window.SUPABASE.session); } catch {}
            } catch {}
          };
          document.head.appendChild(el);
        } catch {}
      })();
    </script>
    <script type="module" src="/js/live/ws.js"></script>
    <script type="module" src="/js/live/status.js"></script>
    <script type="module" src="/js/live/traces.js"></script>
</body>
